<div class="container mb-4">
    <div class="card" style="max-width: 600px; margin: auto">
        <% if (post.banner && post.bannerEncoding) { %>
        <img src="<%= `data:${post.bannerEncoding};charset=utf-8;base64,${post.banner.toString('base64')}` %>" style="max-width: 75%; min-width: fit-content;;">
        <% } %>
        <div class="card-body">
            <h3 class="card-title" style="text-align: center;"><i><%= post.title %></i></h3>
            <p class="card-subtitle text-muted mb-3" style="text-align: center;">by <%= post.authorName %> on <%= post.createdAt.split('T')[0] %>.</p>
            
            <form class="row justify-content-md-center row-cols-lg-auto g-1 align-items-center" method="post" action="<%= post.id %>?_method=DELETE">
                <div class="col-12">
                    <button type="button" class="btn btn-sm btn-outline-secondary" onclick="showToast();copyToClipboard('<%= post.id %>')" id="<%= post.id %>">Copy <i class="fa fa-link fa-sm"></i></button>
                </div>
                <% if (post.authorName == user?.name) { %>
                    <div class="col-12">
                        <a class="btn btn-sm btn-outline-primary" href="<%= post.id %>/edit">Edit <i class="far fa-sm fa-edit"></i></a>
                    </div>
                    <div class="col-12">
                        <button class="btn btn-sm btn-outline-danger" type="submit">Delete <i class="far fa-sm fa-trash-alt"></i></button>
                    </div>
                <% } %>
            </form>
            <% if (post.markdown) { %>
            <hr>
            <%- post.markdown %>
            <% } %> 
        </div>
    </div>
</div>
<div class="position-fixed bottom-0 start-50 translate-middle-x p-3" style="z-index: 5">
    <div id="liveToast" class="toast hide" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
            <div class="toast-body">
                Link copied to clipboard.
            </div>
            <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    </div>
</div>
<script>
    function copyToClipboard(id) {
    var dummy = document.createElement("textarea");
    document.body.appendChild(dummy);
    var copyText = "https://" + window.location.hostname + "/posts/" + id
    dummy.value = copyText;
    dummy.select();
    dummy.setSelectionRange(0, 99999);
    document.execCommand("copy");
    document.body.removeChild(dummy);
}
var toastElList = [].slice.call(document.querySelectorAll('.toast'))
var toastList = toastElList.map(function (toastEl) {
  return new bootstrap.Toast(toastEl)
})
function showToast(){
    toastList[0].show()
}
</script>